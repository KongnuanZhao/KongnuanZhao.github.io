title: 性能测试之时间都去哪了
date: 2014-12-23 11:04:16
author: 赵空暖
tags: 性能测试
categories: 性能测试
---
#总结归纳#
> 只要数据流过的地方，都有可能成为制约其速度的可能。

* 客户端
一个请求发出的过程
1.域名 -> 2.<b>DNS lookup</b> -> 3.返回ip -> 4.通过网络TCP/IP三次握手进行连接的建立 -> 接收解析代码……	
2.1 浏览器查找缓存域名对应的ip
2.2 查找操作系统 ipconfig /dnsflush(清除操作系统缓存)
2.3 浏览器会向web服务提供商(比如电信ADSL)对常见DNS进行缓存
2.4 继续向国家的DNS服务器
2.5 国外的DNS服务器……一直问到分布在世界的几十个根服务器
(DNS劫持、代理服务器)

* 网络
	* 网络拓扑描述--三个层次
		* 核心层：网络主干部分称为核心层，核心层的主要目的在于通过高速转发通信，可靠的骨干传输结构，因此核心层交换机应拥有更高的可靠性，性能和吞吐量。
		* 汇聚层：汇聚层交换层是多台接入层交换机的汇聚点，它必须能够处理来自接入层设备的所有通信量，并提供到核心层的上行链路，因此汇聚层交换机与接入层交换机比较，需要更高的性能，更少的接口和更高的交换速率。
		* 接入层：通常将网络中直接面向用户连接或访问网络的部分称为接入层,接入层目的是允许终端用户连接到网络，因此接入层交换机具有低成本和高端口密度特性
		![network](/image/network.jpg)
	* 网络吞吐量
	* 网络设备连接

(玩游戏或者下载会有区分什么网络进什么区或者通道，比如电信大厅、网通通道，如果电信进入网通会比较慢原因是？)
![net](/image/net.jpg)
以某公司为例，
![company](/image/company.jpg)
首先要使自己的以机房为中心的小型网络连接在一起，然后自己的机房之间要实现互连，自己的机房和其他服务提供商的机房也要实现互连。由于服务提供商自己的机房之间的连接的带宽、连接数都要相对多一些，而网络中跳数越多2个节点间互连的性能就越发低下，如果你的家用电脑与网络游戏服务器同在一个服务提供商下那么连接性能就会更佳。
	
* 应用服务器（Nginx、Apache、iis……)
	* 程序的健壮，消耗资源合理
	* 启动压缩（压缩文本而非其他）
	* 缓存
	* 预热
	* 线程配置
	
* 数据库(oracle、mysql、db2、sql server、nosql(memcached/hbase/radis……))
	* 索引是都正常使用
	* SGA等是否分配合理
	* sql优化


#课程作业#
1.DNS根服务器的概念是什么？
DNS是计算机域名系统(Domain Name System或Domain Name Service)的缩写。由解析器和域名服务器组成。域名服务器是指包括该网络中所有主机的域名和对应IP地址，并将域名转换为IP地址功能的服务器。域名系统类似目录树的等级结构（见下图）下图域名系统等级结构解析流程参看[域名系统等级结构解析流程](http://www.zhaokongnuan.com/2015/01/02/DNS%E5%AD%A6%E4%B9%A0%E6%89%8B%E8%AE%B0/)
![domain](/image/yuming.gif)
将域名映射为IP地址的过程就成为域名解析。域名解析由专门的域名解析服务器来完成，DNS就是进行域名解析的服务器。
根服务器
DNS服务器在域名解析过程中的查询顺序为：本地缓存记录、区域记录、转发域名服务器、根域名服务器（见下图）
![dns](/image/dns.png)
> 全球共有13台根逻辑域名服务器。这13台逻辑根域名服务器中名字分别为“A”至“M”，真实的根服务器在2014年1月25日的数据为386台，分布于全球各大洲。 -百度百科

> 在根域名服务器中虽然没有每个域名的具体信息，但储存了负责每个域（如COM、NET、ORG等）的解析的域名服务器的地址信息，如同通过北京电信你问不到广州市某单位的电话号码，但是北京电信可以告诉你去查020114。世界上所有互联网访问者的浏览器都将域名转化为IP地址的请求（浏览器必须知道数字化的IP地址才能访问网站）理论上都要经过根服务器的指引后去该域名的权威域名服务器(authoritative name server） ，当然现实中提供接入服务的ISP的缓存域名服务器上可能已经有了这个对应关系（域名到IP地址）的缓存。

###关于DNS根镜像服务器###
指的就是DNS根服务器的镜像服务器
镜像服务器(Mirror server)与主服务器的服务内容都是一样的，只是放在一个不同的地方，分担主机的负载。
简单来说就是和照镜子似的，能看，但不是原版的。在网上内容完全相同而且同步更新的两个或多个服务器，除主服务器外，其余的都被称为镜像服务器。

2.网络拓扑结构一般分几层，具体叫什么？
三层：接入层、汇聚层、核心层
3.用自己的话简述一个请求所走过的路径和本节课的感受 
![request](/image/request.png)

感受就是，一直在学校真正实践的机会不多，通过老师的课程能体会到些学即有用，扎实的基础很重要！




---------------

学习的课程来自[炼数成金](http://www.dataguru.cn/)广州八神王磊老师的软件性能测试（第二期）^_^